\chapter{Naive Bayes}

\section{Prétraitement des données}

Un prétraitement des données a d'abord été effectué en utilisant différentes techniques :

\subsubsection{Tokenisation des commentaires}

La \textit{tokenisation} a été utilisée pour diviser les commentaires en \textit{tokens} individuels.

\subsubsection*{Tokenisation à l'aide de n\^otre API \textit{tokenize\_api}}

La \textit{tokenisation} des commentaires a été réalisée en utilisant l'API \textit{tokenize\_api}.

\subsubsection*{Équilibrage du jeu de données}

L'équilibrage du jeu de données à été effectué en échantillonnant un nombre égal de commentaires toxiques et non toxiques.

\section{Analyse exploratoire des données}

Voici les statistiques descriptives sur le jeu de données équilibré :

\subsubsection{Statistiques descriptives}

\begin{itemize}
    \item Nombre total de documents : \textbf{25 962}
    \item Nombre total de \textit{tokens} : \textbf{127 656}
    \item Nombre de classes à prédire : \textbf{2} (toxique ou non toxique)
    \item Les \textit{tokens} les plus fréquents incluent \textbf{"grand", "ter", "burn"}, etc.
\end{itemize}

\section{Entraînement du modèle}

L'entraînement du modèle \textit{Bayésien naïf} à été réalisé en suivant les étapes suivantes :

\subsubsection{Préparation des données}

\begin{itemize}
    \item Calcul de la fréquence des mots et sélection des \textit{StopWords}.
    \item Entraînement du modèle en utilisant \textit{CountVectorizer} et \textit{MultinomialNB}.
\end{itemize}

\subsubsection{Évaluation des performances du modèle}

Les "\textit{Feature Dimensions}" indiquent la taille de la matrice de caractéristiques utilisée pour chaque méthode. Le premier nombre représente le nombre d'échantillons (lignes) dans l'ensemble de données, et le deuxième nombre représente le nombre de caractéristiques (colonnes) générées par le vectoriseur.
Annexe \ref{chap:appendix_rapportclass}



\subsubsection{Validation croisée}

Une validation croisée a également été effectuée en utilisant la métrique \textit{f1\_macro}.

\begin{table}[h]
    \centering
    \begin{tabular}{|l|l|}
    \hline
    \textbf{Métrique} & \textbf{Score} \\ \hline
    f1\_macro (moyenne) & 0.8438 \\ \hline
    f1\_macro (écart type) & 0.0055 \\ \hline
    \end{tabular}
    \caption{Résultats de la validation croisée}
\end{table}

\section{Analyse des résultats}

\subsubsection{Calcul des probabilités}

\begin{itemize}
    \item Probabilités à priori pour chaque classe : \{\textbf{0}: \textbf{0.89831}, \textbf{1}: \textbf{0.10168}\}
    \item Vocabulaire contient \textbf{33397} mots uniques
\end{itemize}

\subsubsection{Calcul des vraisemblances}

Le calcul des vraisemblances a été réalisé pour chaque mot dans chaque classe.

\subsubsection{Prédiction}

Le modèle entraîné a été utilisé pour prédire la toxicité des commentaires de test. Par exemple, le commentaire "\textit{chretian attack}" a été prédit comme toxique avec une probabilité de \textbf{0.000168}.

\subsubsection{Matrice de confusion}

La matrice de confusion montre que le modèle prédit correctement les commentaires toxiques et non toxiques mais dans une large mesure.



\subsubsection{Études Annexe sur les données}

Tableaux récapitulatif de la distribution des données en annexe :  \ref{chap:appendix_rapportclass}
message.txt
4 Ko